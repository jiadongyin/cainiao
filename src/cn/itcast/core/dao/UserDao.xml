<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.itcast.core.dao.UserDao">
	
	<select id="findByName" parameterType="String" resultType="user">
		select * from sec_user where user_name= #{username}
	</select>
	
	<select id="fingRole" parameterType="int" resultType="role">
		select * from sec_role where role_id = #{user_id}
	</select>
	
	<select id="findPermission" parameterType="role" resultType="permission">
		select 
			* 
		from 
			sec_permission 
		where 
			permission_id = any(select permission_id from sec_role_permission where role_id = #{role_id} )
	</select>

    <update id="modifyPass" parameterType="user">
		 UPDATE
			sec_user u 
		 SET
		    u.password = #{password}
		where 
			u.user_id =  #{user_id}
	</update>

</mapper>